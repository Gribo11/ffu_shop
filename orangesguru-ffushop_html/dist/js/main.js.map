{"version":3,"sources":["main.js"],"names":["ffuShop","helpers","nativeChange","e","document","evt","createEvent","initEvent","this","dispatchEvent","fireEvent","createErrorMsg","errObj","text","$","each","error","fields","i","line","errorHandler","Error","UIkit","notification","status","message","errorReject","reject","err","responseJSON","errors","exception","Exception","translation","lang","ua","addToCart","success","notSelected","removeCart","confirm","ok","cancel","cartEmpty","checkout","noDelivery","noUser","user","changePasswordNoEmail","en","routes","getUser","req","url","saveUser","changePass","resetPass","auth","register","cart","getNPDeliveryPrice","getProducts","addProduct","removeProduct","setProductQuantity","registerUser","singleProduct","getProductVariants","getCustomImage","orders","all","details","jQuery","ready","searchClose","target","closest","length","preventDefault","slideUp","off","collapseClose","removeClass","clickParentHandler","on","searchForm","menuCollapse","slideToggle","is","hasClass","toggleClass","window","categorySubnav","switchSubnavView","bound","boundWidth","innerWidth","parseInt","css","next","addClass","find","item","outerWidth","catNav","name","location","origin","pathname","link","$link","attr","parent","sessionStorage","event","documentElement","colorBtn","variationSku","data","card","imageHolder","ajax","type","dataType","res","sku","console","log","image","sku_image","prettifyProducts","products","isEmptyObject","product","qty","price","options","discount","discountPrice","Math","round","color_value","color_value_2","indexOf","ajaxSetup","headers","X-CSRF-TOKEN","store","Vuex","Store","state","first_name","last_name","email","phone","birthday","sex","valid","registered","deliveryProviders","paymentProviders","order","delivery","provider","cost","payment","mutations","providerName","providerOptions","userOptions","option","currentProvider","complete","trigger","setUserInfo","payload","fieldName","fieldValue","createDeliveryProvider","Vue","set","setDeliveryProviderField","setDeliveryProviderCost","setDeliveryProvider","setDeliveryProviderValid","providerValid","createPaymentProvider","setPaymentProvider","getters","active","providers","deliveryDetails","deliveryDetailsWarehouse","warehouse","deliveryCost","deliveryValid","paymentCost","actions","commit","Promise","resolve","extend","dispatch","rowId","component","props","count","Number","max","default","Boolean","min","methods","quantityAdd","blur","$emit","quantityRemove","template","navbar","el","emptyMsg","modalSide","showErrors","password","computed","$store","cartTotal","q","sum","p","quantity","summ","uniqItems","fieldsValid","test","checkCart","href","changeSide","side","refresh","update","$refs","self","mask","value","userLogin","method","then","modal","hide","catch","userRegister","allValid","field","finally","changePassword","created","watch","setTimeout","id","attributes","color","current","size","slideshow","obj","pictures","productVariants","maxQuantity","that","Object","keys","checkAtts","newAttr","inArray","push","in_stock","value_2","slideIndex","checkPicks","colorId","picObj","picId","productSku","productOpts","$forceUpdate","setAttribute","show","quantityChange","old","getAttrClass","attrName","updateData","index","fits","stock_level","hasOwnProperty","activeAtts","att","variant","sku_id","product_id","color_name","mounted","ratio","userAccountLang","male","female","noEmail","badEmail","noPhone","badPhone","noNames","passMissMatch","emptyFields","userSaved","datepicker","setDefaults","dayNamesMin","monthNamesShort","userAccount","page","editing","editedFields","val","new","repeat","class","sexTranslated","forEach","j","disc","orderTotal","totals","total","transBeforeEnter","style","display","transEnter","done","delay","slideDown","transLeave","setPage","num","setNewValue","saveUserData","msgText","changeView","repeatPassClass","resetRepeatPassClass","old_password","new_password","getOrders","isEditing","dpInt","setInterval","clearInterval","changeMonth","changeYear","dateFormat","firstDay","maxDate"],"mappings":"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","file":"main.js","sourcesContent":["var ffuShop = ffuShop || {};\r\n\r\n\r\n\r\n/*\r\n * Helpers\r\n */\r\n\r\nffuShop.helpers = {\r\n    \r\n    // trigger native browser change event in jQuery objects\r\n    nativeChange : function(e) {\r\n        if ( 'originalEvent' in e ) return;\r\n        if (\"createEvent\" in document) {\r\n            var evt = document.createEvent(\"HTMLEvents\");\r\n            evt.initEvent(\"change\", false, true);\r\n            this.dispatchEvent(evt);\r\n        }\r\n        else { \r\n            this.fireEvent(\"onchange\")\r\n        };\r\n    },\r\n    \r\n    // creates error html from error object\r\n    createErrorMsg : function( errObj ) {\r\n        var text = '<ol class=\"uk-text-left\">';\r\n        $.each(errObj, function(error, fields){\r\n            text += '<li>';\r\n            $.each(fields, function(i, line){\r\n                text += line + '<br>'\r\n            });\r\n            text += '</li>';\r\n        });\r\n        text += '</ol>';        \r\n        return text;\r\n    },\r\n    \r\n    errorHandler : function( errObj ) {\r\n        if ( errObj instanceof Error ) {\r\n            throw errObj;\r\n        } else {\r\n            UIkit.notification({\r\n                status : 'danger',\r\n                message : ffuShop.helpers.createErrorMsg(errObj)\r\n            })\r\n        }\r\n    },\r\n    \r\n    // rejects promise with no 200 status\r\n    errorReject : function( reject, err, text ) {\r\n        if ( err.responseJSON ) {\r\n            if ( err.responseJSON.errors ) {   \r\n                reject( err.responseJSON.errors );\r\n            } else if ( err.responseJSON.exception ) {\r\n                reject({\r\n                    Exception : [text, err.responseJSON.exception]\r\n                })\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n/*\r\n * Global Translations\r\n */\r\n\r\nffuShop.translation = {\r\n    lang: 'ua',\r\n    ua: {\r\n        addToCart: {\r\n            success: 'шт. додано до кошика',                \r\n            notSelected : 'На жаль, цей товар вiсутнiй...'\r\n        },\r\n        removeCart: {\r\n            confirm: 'Видалити ',\r\n            ok: 'Так',\r\n            cancel: 'Нi'\r\n        },\r\n        cartEmpty: {\r\n            message: 'Немає жодного товару...'\r\n        },\r\n        checkout : {\r\n            noDelivery : 'Не заповнена iнформацiя обраного способу доставки...',\r\n            noUser : 'Особисті дані не заповнені...'\r\n        },\r\n        user : {\r\n            changePasswordNoEmail : 'Будь ласка, вкажiть email за яким ви зареєструвались',\r\n        }\r\n    },\r\n    en: {\r\n        addToCart: {\r\n            success: 'pcs. added to cart',\r\n            notSelected : 'Product is out of stock...'\r\n        },\r\n        removeCart: {\r\n            confirm: 'Delete ',\r\n            ok: 'Yes',\r\n            cancel: 'No'\r\n        },\r\n        cartEmpty: {\r\n            message: 'No products in cart...'\r\n        },\r\n        checkout : {\r\n            noDelivery : 'Delivery method data is not filled...',\r\n            noUser : 'Personal data is not filled...'\r\n        },\r\n        user : {\r\n            changePasswordNoEmail : 'Plase enter an email you registered with',\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n/*\r\n * API Routes\r\n */\r\n\r\n\r\n ffuShop.routes = {\r\n    \r\n    user : {\r\n        getUser : {\r\n            req : 'post',\r\n            url : '/user/get',\r\n        },\r\n        saveUser : {\r\n            req : 'post',\r\n            url : '/user/save'\r\n        },\r\n        changePass : {\r\n            req : 'post',\r\n            url : '/user/changepass'\r\n        },\r\n        resetPass : {\r\n            req : 'post',\r\n            url : '/user/resetpass'\r\n        },\r\n        auth : {\r\n            req : 'post',\r\n            url : '/user/auth'\r\n        },\r\n        register : {\r\n            req : 'post',\r\n            url : '/user/register'\r\n        }\r\n    },\r\n    cart : {\r\n        getNPDeliveryPrice: {\r\n            req : 'post',\r\n            url : '/getNPDeliveryPrice'\r\n        },\r\n\r\n        getProducts : {\r\n            req : 'post',\r\n            url : '/cart/get'\r\n        },\r\n        addProduct : {\r\n            req : 'post',\r\n            url : '/cart/add'\r\n        },\r\n        removeProduct : {\r\n            req : 'post',\r\n            url : '/cart/remove'\r\n        },\r\n        setProductQuantity : {\r\n            req : 'post',\r\n            url : '/cart/row/update'\r\n        },\r\n        registerUser : {\r\n            req : 'post',\r\n            url : '/cart/user/reg'\r\n        }\r\n    },\r\n    checkout : {\r\n        confirm : {\r\n            req : 'post',\r\n            url : '/cart/checkout'\r\n        }\r\n    },\r\n    singleProduct : {\r\n        getProductVariants : {\r\n            req : 'post',\r\n            url : '/product/json/sku/'\r\n        },\r\n        getCustomImage : {\r\n            req : 'post',\r\n            url : '/product/custom/'\r\n        }\r\n    },\r\n    orders : {\r\n        all : {\r\n            req : 'post',\r\n            url : '/order/list'\r\n        },\r\n        details : {\r\n            req : 'post',\r\n            url : '/order/details'\r\n        }\r\n    }\r\n} \r\n\r\n\r\njQuery(document).ready(function($){\r\n    \r\n    /*\r\n     * Navbar togglers\r\n     */\r\n    \r\n    function searchClose(e) {\r\n                \r\n        if ( $(e.target).closest('#fsSearch').length ) return;\r\n        \r\n        e.preventDefault();\r\n        $('#fsSearch').slideUp('fast');\r\n        $('body').off('click', searchClose);        \r\n    }\r\n    \r\n    function collapseClose(e) {\r\n        \r\n        if ( $(e.target).closest('#fsMenuCollapse').length ||\r\n             $(e.target).closest('#fsMenuToggle').length ) return;\r\n        \r\n        e.preventDefault();\r\n        $('#fsMenuCollapse').removeClass('uk-open uk-animation-fade uk-animation-fast').off('click', clickParentHandler);\r\n        $('body').off('click', collapseClose);        \r\n    }\r\n    \r\n    function clickParentHandler(e) {\r\n        if ( ! $(e.target).closest('.uk-navbar-dropdown-nav').length ) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n    \r\n    $('.fs-search-open').on( 'click', function(){\r\n        \r\n        var searchForm = $('#fsSearch');\r\n        var menuCollapse = $('#fsMenuCollapse');\r\n        \r\n        searchForm.slideToggle('fast', function(){\r\n            if ( searchForm.is(':visible') ) {\r\n                $('body').on('click', searchClose)\r\n            }\r\n        });\r\n        \r\n        if ( menuCollapse.hasClass('uk-open') ) {            \r\n            menuCollapse.removeClass('uk-open uk-animation-fade uk-animation-fast');\r\n            $('body').off('click', collapseClose);\r\n        }\r\n    })\r\n    \r\n    $('#fsMenuToggle').on('click', function(){\r\n        \r\n        var menuCollapse = $('#fsMenuCollapse');\r\n        \r\n        $('#fsSearch').slideUp('fast');\r\n        $('body').off('click', searchClose);\r\n        menuCollapse.toggleClass('uk-open uk-animation-fade uk-animation-fast');\r\n        \r\n        if ( menuCollapse.is(':visible') ) {       \r\n            $('body').on('click', collapseClose);\r\n            menuCollapse.on('click', '.uk-parent', clickParentHandler);\r\n        } else {\r\n            $('body').off('click', collapseClose)\r\n            menuCollapse.off('click', clickParentHandler)\r\n        }        \r\n    })\r\n    \r\n    /*\r\n     * Responsive category subnav\r\n     */\r\n    \r\n    $(window).on('load', function(){\r\n        \r\n        var categorySubnav = $('#fsCategoryView .uk-subnav');\r\n        var length = 0;\r\n        \r\n        function switchSubnavView() {\r\n            \r\n            var bound = categorySubnav.closest('.uk-container');\r\n            var boundWidth = bound.innerWidth() - parseInt(bound.css('padding-left') ) - parseInt(bound.css('padding-right'));            \r\n            var display = ( boundWidth > length ? 'desktop' : 'mobile' );\r\n            \r\n            switch ( display ) {                    \r\n                case 'desktop' :\r\n                    categorySubnav.removeClass('uk-hidden');\r\n                    categorySubnav.next().addClass('uk-hidden');\r\n                    break;                    \r\n                case 'mobile' :\r\n                default :\r\n                    categorySubnav.addClass('uk-hidden');\r\n                    categorySubnav.next().removeClass('uk-hidden');\r\n                    break;\r\n            }            \r\n        }\r\n        \r\n        if ( !categorySubnav ) return;\r\n        \r\n        categorySubnav.find(' > li').each(function(i, item){\r\n            length += $(item).outerWidth();\r\n        });\r\n        length -= 20; // margin\r\n        \r\n        switchSubnavView();        \r\n        $(window).on('resize', switchSubnavView);\r\n    })\r\n    \r\n    \r\n    // Set category active class    \r\n    var catNav = $('#fsCategoryView > .uk-container > .uk-subnav > li > a, .fs-category-responsive .uk-nav > li > a, .fs-sidebar-nav .uk-list > li > a');\r\n\r\n    if ( catNav.length ) {        \r\n        var url = location.origin + location.pathname;\r\n        var name;\r\n        catNav.each(function(i, link){\r\n            var $link = $(link);\r\n            if ( $link.attr('href') == url ) {\r\n                $link.parent().addClass('uk-active');\r\n                name = $link.text();\r\n            }\r\n        });\r\n        $('.fs-category-responsive .fs-cat-name').text( name );\r\n    }\r\n    \r\n    \r\n    \r\n    /*\r\n     * Handle small product card color click\r\n     */\r\n    \r\n    if ( sessionStorage ) {\r\n    \r\n        var event = ( (\"ontouchstart\" in document.documentElement) ? 'click' : 'mouseenter' );\r\n\r\n        $('body').on(event, '.fs-product-card[data-product-id] .fs-product-colors > li', function(e){\r\n                        \r\n            var colorBtn = $(e.target).closest('li');\r\n            var variationSku = colorBtn.data('sku');\r\n\r\n            if ( ! variationSku ) return;\r\n\r\n            var card = colorBtn.closest('.fs-product-card');\r\n            var imageHolder = card.find('.fs-product-card-image');\r\n\r\n            if ( sessionStorage[variationSku] ) {\r\n\r\n                if ( sessionStorage[variationSku] == 'no_image' ) return;\r\n                \r\n                imageHolder.css('background-image', 'url(' + sessionStorage[variationSku] + ')' );\r\n                return;\r\n            }\r\n\r\n            $.ajax({\r\n                type: ffuShop.routes.cart.getNPDeliveryPrice.req,\r\n                url: ffuShop.routes.cart.getNPDeliveryPrice.url + card.data('product-id'),\r\n                dataType: 'json',\r\n                success: function(res){\r\n                    console.log(res);\r\n                    for ( sku in res ) {\r\n                        var image = res[sku].sku_image ? res[sku].sku_image : 'no_image';\r\n                        if ( image != 'no_image' ) imageHolder.css('background-image', 'url(' + image + ')' );\r\n                        sessionStorage[sku] = image;\r\n                    }\r\n                }\r\n            })\r\n        })\r\n    \r\n    }\r\n    \r\n    \r\n    \r\n    /*\r\n     * Define translation language\r\n     */\r\n    \r\n    ffuShop.translation = ffuShop.translation || {};\r\n    \r\n    if ( ~$('html').attr('lang').indexOf('en') ) ffuShop.translation.lang = 'en';\r\n    \r\n    \r\n    \r\n    /*\r\n     * Token \r\n     */\r\n    \r\n    $.ajaxSetup({\r\n        dataType : 'json',\r\n        headers: {\r\n            'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n        },\r\n    });\r\n    \r\n    \r\n    \r\n    /*\r\n     * Data Store\r\n     */\r\n    \r\n    function prettifyProducts(products) {\r\n\r\n    if ( $.isEmptyObject(products) ) return null;\r\n\r\n    $.each(products, function(i, product){\r\n        // qty and price are integer\r\n        product.qty = parseInt(product.qty);\r\n        product.price = parseInt(product.price);\r\n        \r\n        if ( ! product.options ) return;\r\n        \r\n        // discount\r\n        if ( ! product.options.discount ) {\r\n            product.options.discount = null;\r\n            product.discountPrice = product.price;\r\n        } else {\r\n            product.options.discount = parseInt( product.options.discount );\r\n            product.discountPrice = Math.round( product.price * (1 + product.options.discount / 100) );\r\n        }\r\n        \r\n        //colors\r\n        if ( ! product.options.color_value ) return;\r\n        product.options.color_value_2 = product.options.color_value_2 || product.options.color_value;\r\n    });\r\n    return products;\r\n};\r\n\r\nffuShop.store = new Vuex.Store({\r\n    state : {\r\n        products : [],\r\n        user : {\r\n            first_name : \"\",\r\n            last_name : \"\",\r\n            email : \"\",\r\n            phone : \"\",\r\n            birthday : \"\",\r\n            sex : null,\r\n            valid : false,\r\n            registered : false,\r\n        },\r\n        deliveryProviders : {},\r\n        paymentProviders : {},\r\n        order : {\r\n            delivery : {\r\n                provider : null,\r\n                cost : 0,\r\n            },\r\n            payment : {\r\n                provider : null,\r\n                cost : 0\r\n            }\r\n        }\r\n    },\r\n    mutations : {\r\n\r\n        addProduct : function( state, product ) {\r\n            $.ajax({\r\n                url : ffuShop.routes.cart.addProduct.url,\r\n                type : ffuShop.routes.cart.addProduct.req,\r\n                data : product,\r\n                dataType : 'json',\r\n                success : function(res){\r\n                    state.products = prettifyProducts(res);\r\n\r\n                    UIkit.notification({\r\n                        status : 'success',\r\n                        message : '<span uk-icon=\"icon: check\"></span> ' + product.name + ' x ' + product.qty + ffuShop.translation[ ffuShop.translation.lang ].addToCart.success\r\n                    });\r\n                }\r\n            });               \r\n        },\r\n\r\n        getProducts : function( state ) {\r\n            $.ajax({\r\n                url : ffuShop.routes.cart.getProducts.url,\r\n                type : ffuShop.routes.cart.getProducts.req,\r\n                dataType : 'json',\r\n                success : function(res){\r\n                    state.products = prettifyProducts(res);\r\n                }\r\n            });  \r\n        },\r\n\r\n        getUser : function( state ) {\r\n            $.ajax({\r\n                url : ffuShop.routes.user.getUser.url,\r\n                type : ffuShop.routes.user.getUser.req,\r\n                dataType : 'json',\r\n                success : function(res) {\r\n\r\n                    if ( ! res ) return; // null in response\r\n                    \r\n                    // formatting data\r\n                    res.valid = true;\r\n                    res.registered = true;\r\n                    res.birthday = ( res.birthday ? res.birthday : '' );\r\n\r\n                    if ( res.deliveryProviders\r\n                         && ! $.isEmptyObject(res.deliveryProviders) ) {\r\n\r\n                        for ( providerName in state.deliveryProviders ) {\r\n\r\n                            if ( providerName in res.deliveryProviders ) {\r\n\r\n                                // copy provider options\r\n                                var providerOptions = state.deliveryProviders[providerName].options;\r\n                                var userOptions = res.deliveryProviders[providerName].options; \r\n\r\n                                for ( option in userOptions ) {\r\n                                    providerOptions[option] = userOptions[option]\r\n                                }\r\n\r\n                                // set provider validation\r\n                                state.deliveryProviders[providerName].valid = res.deliveryProviders[providerName].valid;\r\n\r\n                                // toggle provider if valid\r\n                                var currentProvider = state.order.delivery.provider\r\n                                if ( res.deliveryProviders[providerName].valid\r\n                                     && ! state.deliveryProviders[currentProvider].valid ) {\r\n                                    state.order.delivery.provider = providerName;\r\n                                    state.order.delivery.cost = state.deliveryProviders[providerName].cost;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        delete res.deliveryProviders; \r\n                    }\r\n\r\n                    state.user = res;\r\n                },\r\n                complete : function(){ \r\n                    $(window).trigger('fs.user.loaded')\r\n                }\r\n            });\r\n        },\r\n\r\n        setUserInfo : function( state, payload ) {\r\n            var fieldName = payload[0],\r\n                fieldValue = payload[1];\r\n            state.user[fieldName] = fieldValue;\r\n        },\r\n                \r\n        createDeliveryProvider : function( state, payload ) {\r\n            var providerName = payload[0],\r\n                providerOptions = payload[1];\r\n\r\n            // update storage\r\n            Vue.set( state.deliveryProviders, providerName, providerOptions);\r\n\r\n            // set default delivery provier if not exists\r\n            if ( ! state.order.delivery.provider ) {\r\n                state.order.delivery = {\r\n                    provider : providerName,\r\n                    cost : providerOptions.cost\r\n                }\r\n            }\r\n        },\r\n\r\n        setDeliveryProviderField : function( state, payload ) {\r\n            var providerName = payload[0],\r\n                fieldName = payload[1],\r\n                fieldValue = payload[2];\r\n\r\n            state.deliveryProviders[providerName].options[fieldName] = fieldValue;\r\n        },\r\n        setDeliveryProviderCost : function( state, payload ) {\r\n            var providerName = payload[0],\r\n                fieldValue = payload[1];\r\n            state.deliveryProviders[providerName].cost = fieldValue;\r\n        },\r\n\r\n        setDeliveryProvider : function( state, providerName ) {\r\n            state.order.delivery.provider = providerName;\r\n            state.order.delivery.cost = state.deliveryProviders[providerName].cost;\r\n        },\r\n\r\n        setDeliveryProviderValid : function( state, payload ) { \r\n            var providerName = payload[0],\r\n                providerValid = payload[1];\r\n\r\n            state.deliveryProviders[providerName].valid = providerValid;\r\n        },\r\n\r\n        createPaymentProvider : function( state, payload ) {\r\n            var providerName = payload[0],\r\n                providerOptions = payload[1];\r\n\r\n            // update storage\r\n            Vue.set( state.paymentProviders, providerName, providerOptions);\r\n\r\n            // set default delivery provier if not exists\r\n            if ( ! state.order.payment.provider ) {\r\n                state.order.payment = {\r\n                    provider : providerName,\r\n                    cost : providerOptions.cost\r\n                }\r\n            }\r\n        },\r\n\r\n        setPaymentProvider : function( state, providerName ) {\r\n            state.order.payment.provider = providerName;\r\n            state.order.payment.cost = state.paymentProviders[providerName].cost;\r\n        }\r\n    },\r\n    getters : {\r\n        \r\n        user : function( state ) {\r\n            \r\n            return ( state.user.registered ? state.user : false );\r\n        },\r\n        \r\n        products : function( state ) {\r\n\r\n            return ( $.isEmptyObject(state.products) ? null : state.products );\r\n        },\r\n\r\n        delivery : function( state ) {                \r\n            return {\r\n                active : state.order.delivery.provider,\r\n                providers : state.deliveryProviders,                    \r\n            }\r\n        },\r\n\r\n        deliveryDetails : function( state ) {\r\n            \r\n            if ( $.isEmptyObject( state.deliveryProviders ) ) return false;\r\n            \r\n            return state.deliveryProviders[ state.order.delivery.provider ].options.details\r\n            //return state.deliveryProviders[ state.order.delivery.provider ].options\r\n        },\r\n        deliveryDetailsWarehouse : function( state ) {\r\n            if ( $.isEmptyObject( state.deliveryProviders ) ) return false;\r\n            return state.deliveryProviders[ state.order.delivery.provider ].options.warehouse\r\n            //return state.deliveryProviders[ state.order.delivery.provider ].options\r\n        },\r\n\r\n        deliveryCost : function( state ) {\r\n            if ( ! state.order.delivery.provider ) return 0;                \r\n            return state.deliveryProviders[ state.order.delivery.provider ].cost\r\n        },\r\n\r\n        deliveryValid : function( state ) {\r\n\r\n            if ( ! state.order.delivery.provider ) return false;\r\n            return state.deliveryProviders[ state.order.delivery.provider ].valid\r\n        },\r\n\r\n        payment : function( state ) {                \r\n            return {\r\n                active : state.order.payment.provider,\r\n                providers : state.paymentProviders\r\n            }\r\n        },\r\n\r\n        paymentCost : function( state ) {\r\n            if ( ! state.order.payment.provider ) return 0;                \r\n            return state.paymentProviders[ state.order.payment.provider ].cost\r\n        }\r\n    },\r\n    actions : {\r\n        getProducts : function( store ) {\r\n            store.commit('getProducts')\r\n        },\r\n        addProduct : function( store, payload ) {\r\n            store.commit('addProduct', payload)\r\n        },\r\n        getUser : function( store ) {\r\n            store.commit('getUser');\r\n        },\r\n        saveUser : function( store, payload ) {            \r\n            return new Promise(function(resolve, reject) {                \r\n                var user = $.extend( {}, store.state.user, payload);\r\n                $.ajax({\r\n                    url : ffuShop.routes.user.saveUser.url,\r\n                    type : ffuShop.routes.user.saveUser.req,\r\n                    dataType : 'json',\r\n                    data : user,\r\n                    success : function(res) {                        \r\n                        if ( res.errors &&\r\n                         ! $.isEmptyObject(res.errors) ) {\r\n                            reject(res.errors);\r\n                        } else {\r\n                            resolve();\r\n                            store.dispatch('getUser');\r\n                        }\r\n                    },\r\n                    error : function(err) {\r\n                        reject(err);\r\n                    }\r\n                });\r\n            })\r\n        },\r\n        setProductQuantity : function( store, payload ) {             \r\n            return new Promise(function(resolve, reject) {\r\n                $.ajax({\r\n                    type: ffuShop.routes.cart.setProductQuantity.req,\r\n                    url : ffuShop.routes.cart.setProductQuantity.url,\r\n                    dataType : 'json',\r\n                    data : {\r\n                        rowId : payload[0],\r\n                        qty : payload[1]\r\n                    },\r\n                    success : function(res) {                        \r\n                        if ( res.errors &&\r\n                         ! $.isEmptyObject(res.errors) ) {\r\n                            for ( rowId in res.errors ) {\r\n                                store.state.products[ rowId ].qty = parseInt(res.errors[rowId]);\r\n                            }\r\n                            reject(res.message);\r\n                        } else {\r\n                            resolve();\r\n                        }\r\n                    }\r\n                })\r\n            });\r\n        },\r\n        removeProduct : function ( store, rowId ) {\r\n            return new Promise(function(resolve, reject){\r\n                $.ajax({\r\n                    type: ffuShop.routes.cart.removeProduct.req,\r\n                    url : ffuShop.routes.cart.removeProduct.url,\r\n                    data : {rowId : rowId},\r\n                    dataType : 'json',\r\n                    success : function(res){                        \r\n                        store.state.products = prettifyProducts(res);   \r\n                        // redirect to homepage if empty                        \r\n                        if ( ! store.state.products ) window.location = '/'; \r\n                        resolve();\r\n                    }\r\n                });\r\n            });\r\n        },\r\n    }\r\n});\r\n    \r\n    \r\n    \r\n    /*\r\n     * Quantity component\r\n     */\r\n    \r\n    Vue.component('quantity-counter', {\r\n    props : {\r\n        count : {\r\n            type : Number\r\n        },\r\n        rowId : null,\r\n        max : {\r\n            type : Number,\r\n            default : 10,\r\n        },\r\n        active : Boolean,\r\n    },\r\n    data : function() {\r\n        return {\r\n            min : 1\r\n        }\r\n    },\r\n    methods : {\r\n\r\n        quantityAdd : function(e) {\r\n            e.target.blur();\r\n            if ( ! this.active ) return;\r\n            var count = +this.count + ( this.count < this.max );\r\n            this.$emit('change', this.count, count, this.rowId);\r\n        },\r\n        quantityRemove : function(e) {\r\n            e.target.blur();\r\n            if ( ! this.active ) return;\r\n            var count = this.count - ( this.count > this.min );\r\n            this.$emit('change', this.count, count, this.rowId);\r\n        }\r\n    },\r\n    template : '<div class=\"fs-product-quantity\" :class=\"{\\'uk-disabled\\':!active}\">\\\r\n                    <a href=\"\" @click.prevent=\"quantityRemove\">-</a>\\\r\n                    <span>{{ count }}</span>\\\r\n                    <a href=\"\" @click.prevent=\"quantityAdd\">+</a>\\\r\n                </div>'\r\n});\r\n    \r\n    \r\n    \r\n    /*\r\n     * Instances\r\n     */\r\n    \r\n    /*\r\n * Navbar\r\n */\r\n\r\nffuShop.navbar = new Vue({\r\n    el: '#fsNavbar',\r\n    store : ffuShop.store,\r\n    data : function() {\r\n        return {\r\n            emptyMsg : ffuShop.translation[ ffuShop.translation.lang ].cartEmpty.message,\r\n            active : true,\r\n            modalSide : 'login',\r\n            showErrors : false,\r\n            fields : {\r\n                first_name : '',\r\n                last_name :  '',\r\n                phone : '',\r\n                email : '',\r\n                password : ''                \r\n            }\r\n        }\r\n    },\r\n    computed : {\r\n        products : function(){\r\n            return this.$store.getters.products;\r\n        },\r\n        user : function(){\r\n            return this.$store.getters.user;\r\n        },\r\n        cartTotal : function(){\r\n            var q = 0, sum = 0 , i = 0;\r\n            for ( p in this.products ) {\r\n                i++;\r\n                q += +this.products[p].qty;\r\n                sum += this.products[p].qty * this.products[p].discountPrice;\r\n            };\r\n            return { \r\n                quantity : q,\r\n                summ : Math.round(sum),\r\n                uniqItems : i,\r\n            };\r\n        },\r\n        fieldsValid : function() {\r\n            \r\n            return {\r\n                first_name : !!this.fields.first_name && /^[a-zа-я ,.\\'-]+$/i.test(this.fields.first_name),\r\n                \r\n                last_name : /^[a-zа-я ,.\\'-]+$/i.test(this.fields.last_name),\r\n                \r\n                phone : !!this.fields.phone && /\\+38\\([0-9]{3}\\)[0-9]{3}-[0-9]{2}-[0-9]{2}/.test(this.fields.phone),\r\n                \r\n                email : !!this.fields.email && /^([\\w.*-]+@([\\w-]+\\.)+[\\w-]{2,4})$/.test(this.fields.email), \r\n                \r\n                password : this.fields.password.length > 3,\r\n            }\r\n        }\r\n    },\r\n    methods : {\r\n        checkCart : function(e) {\r\n            if ( $.isEmptyObject( this.products ) ) {\r\n                UIkit.notification({\r\n                    status: 'warning',\r\n                    message: this.emptyMsg\r\n                })\r\n            } else {\r\n                window.location = e.target.href;\r\n            }\r\n        },\r\n        changeSide : function(side) {\r\n            this.modalSide = side            \r\n        },\r\n        refresh : function() {\r\n            UIkit.update(event = 'update');            \r\n            if ( this.$refs.phone ) {\r\n                var self = this;\r\n                $(this.$refs.phone).mask('+38(999)999-99-99')\r\n                                   .on('change', function(e){\r\n                                            self.fields.phone = e.target.value;\r\n                                        });\r\n            }\r\n        },\r\n        userLogin : function() {\r\n            \r\n            if ( this.fieldsValid.email &&\r\n                 this.fieldsValid.password ) {\r\n                \r\n                var data = {\r\n                    email : this.fields.email,\r\n                    password : this.fields.password\r\n                }\r\n                \r\n                new Promise( function(resolve, reject){ \r\n                    $.ajax({\r\n                        url : ffuShop.routes.user.auth.url,\r\n                        method : ffuShop.routes.user.auth.req,\r\n                        dataType : 'json',\r\n                        data : data,\r\n                        success : function( res ){\r\n                            if ( ! res.errors ) {\r\n                                resolve(res);\r\n                            } else { reject(res.errors); }\r\n                        },\r\n                        error : function(err, text) {\r\n                            ffuShop.helpers.errorReject(reject, err, text)\r\n                        }\r\n                    })\r\n                }).then(function(res){\r\n                    ffuShop.store.dispatch('getUser');\r\n                    UIkit.modal('#fsLoginModal').hide();\r\n                }).catch(ffuShop.helpers.errorHandler);\r\n                \r\n            } else {\r\n                \r\n                this.showErrors = true;\r\n            }\r\n        },\r\n        userRegister : function() {\r\n            \r\n            var allValid = true;\r\n            \r\n            for ( field in this.fieldsValid ) {\r\n                \r\n                allValid = allValid && this.fieldsValid[field];\r\n            }\r\n            \r\n            if ( allValid ) {\r\n                \r\n                this.active = false;\r\n                var self = this;\r\n                \r\n                new Promise( function(resolve, reject){ \r\n                    $.ajax({\r\n                        url : ffuShop.routes.user.register.url,\r\n                        method : ffuShop.routes.user.register.req,\r\n                        data : self.fields,\r\n                        dataType : 'json',\r\n                        success : function( res ){\r\n                            if ( ! res.errors ) {\r\n                                resolve(res);\r\n                            } else { reject(res.errors); }\r\n                        },\r\n                        error : function(err, text) {\r\n                            ffuShop.helpers.errorReject(reject, err, text)\r\n                        }\r\n                    })\r\n                }).then(function(res){\r\n                    UIkit.notification({\r\n                        status : 'success',\r\n                        message : res.message\r\n                    });\r\n                    UIkit.modal('#fsLoginModal').hide();\r\n                }).catch(ffuShop.helpers.errorHandler)\r\n                  .finally(function(){\r\n                    self.active = true;\r\n                });\r\n                \r\n            } else {\r\n                \r\n                this.showErrors = true;\r\n            }\r\n        },\r\n        changePassword : function() {\r\n            \r\n            // check if email exist\r\n            if ( ! this.fieldsValid.email ) {\r\n                \r\n                this.showErrors = true;\r\n                \r\n                UIkit.notification({\r\n                    status : 'danger',\r\n                    message : ffuShop.translation[ffuShop.translation.lang].user.changePasswordNoEmail\r\n                });\r\n                \r\n                return;\r\n            }\r\n            \r\n            // request password change\r\n            this.active = false;\r\n            var self = this;\r\n            new Promise(function(resolve, reject){\r\n                $.ajax({\r\n                    url : ffuShop.routes.user.resetPass.url,\r\n                    method : ffuShop.routes.user.resetPass.req,\r\n                    data : self.fields,\r\n                    dataType : 'json',\r\n                    success : function( res ){\r\n                        if ( ! res.errors ) {\r\n                            resolve(res);\r\n                        } else { reject(res.errors); }\r\n                    },\r\n                    error : function(err, text) {\r\n                        ffuShop.helpers.errorReject(reject, err, text)\r\n                    }\r\n                })\r\n            }).then(function(res){\r\n                UIkit.notification({\r\n                    status : 'success',\r\n                    message : res.message\r\n                });\r\n                UIkit.modal('#fsLoginModal').hide();\r\n            }).catch(ffuShop.helpers.errorHandler)\r\n              .finally(function(){\r\n                self.active = true;\r\n            });\r\n        }\r\n    },\r\n    created : function(){\r\n         this.$store.dispatch('getProducts');\r\n         this.$store.dispatch('getUser');\r\n    },\r\n    watch : {\r\n        showErrors : function(on) {\r\n            var self = this;\r\n            if ( on ) setTimeout(function(){\r\n                self.showErrors = false;\r\n            }, 2000)\r\n        }\r\n    }\r\n});\r\n    \r\n    /*\r\n * Single product\r\n */\r\n\r\nif ( $('#fsProductSingle').length ) {\r\n\r\n    ffuShop.singleProduct = new Vue({\r\n        el: '#fsProductSingle',\r\n        data: {\r\n            id: null,\r\n            name: '',\r\n            sku: null,\r\n            price: null,\r\n            discount: null,\r\n            attributes: {\r\n                color: {\r\n                    current: null\r\n                },\r\n                size: {\r\n                    current: null\r\n                }\r\n            },\r\n            slideshow : {\r\n                obj: null,\r\n                pictures : {}\r\n            },\r\n            productVariants : null,\r\n            quantity: 1,\r\n            max: 10\r\n        },\r\n        store : ffuShop.store,\r\n        computed : {\r\n            maxQuantity : function() {                \r\n                return ( this.max > 10 ? 10 : this.max );\r\n            },\r\n            discountPrice : function() {\r\n                if ( ! this.discount ) return this.price;\r\n                return Math.round( this.price * (1 + parseInt(this.discount) / 100 ) );\r\n            }\r\n        },\r\n        methods: {\r\n            getProductVariants : function() {\r\n                var that = this;\r\n                \r\n                $.ajax({\r\n                    url : ffuShop.routes.singleProduct.getProductVariants.url + that.id,\r\n                    type : ffuShop.routes.singleProduct.getProductVariants.req,\r\n                    dataType: 'json',\r\n                }).then(function(res){\r\n                    \r\n                    // multi variant product\r\n                    if ( Object.keys(res).length > 1 ) {\r\n                        \r\n                        that.productVariants = res;\r\n\r\n                        // create attributes\r\n                        for ( name in that.attributes ) {\r\n\r\n                            var checkAtts = [];\r\n\r\n                            for ( sku in that.productVariants ) {\r\n\r\n                                var newAttr = {},\r\n                                    attr = that.productVariants[sku][name];\r\n\r\n                                if ( ! attr ) continue;\r\n\r\n                                if ( ~$.inArray( attr.id, checkAtts ) ) continue;\r\n\r\n                                checkAtts.push( attr.id );\r\n                                $.extend( newAttr, attr );\r\n                                newAttr.active = (name == 'color' ? true : that.productVariants[sku].in_stock );\r\n\r\n                                // duplicate color 2 if not exist\r\n                                if ( name == 'color' && ! newAttr.value_2 ) newAttr.value_2 = newAttr.value;\r\n\r\n                                if ( ! that.attributes[name].all ) that.attributes[name].all = [];\r\n\r\n                                that.attributes[name].all.push( newAttr );\r\n                            }\r\n                        };\r\n\r\n                        // create slides\r\n                        var slideIndex = 0,                            \r\n                            checkPicks = [];\r\n\r\n                        for ( sku in that.productVariants ) {\r\n\r\n                            // if no color image is dropped\r\n                            if ( ! that.productVariants[sku].color ) {\r\n\r\n                                if ( ! that.productVariants[sku].sku_image ) continue;\r\n\r\n                                var picId = 'pic_' + slideIndex; \r\n\r\n                                var picObj = {\r\n                                    slideIndex : slideIndex,\r\n                                    name: picId,\r\n                                    image: that.productVariants[sku].sku_image\r\n                                };\r\n                                that.slideshow.pictures[picId] = picObj;\r\n                                slideIndex++;\r\n\r\n                                continue;\r\n                            }\r\n\r\n                            var colorId = 'color_' + that.productVariants[sku].color.id;\r\n\r\n                            if ( ! that.productVariants[sku].sku_image || ~$.inArray(colorId,  checkPicks) ) continue;\r\n\r\n                            checkPicks.push( colorId );\r\n                            var picObj = {\r\n                                slideIndex : slideIndex++,\r\n                                name: that.productVariants[sku].color.name,\r\n                                image: that.productVariants[sku].sku_image\r\n                            };\r\n                            that.slideshow.pictures[colorId] = picObj;\r\n                        }\r\n                        \r\n                    } else {\r\n                        \r\n                        // single product  \r\n                        var productSku = Object.keys(res)[0],\r\n                            productOpts = res[productSku];\r\n                        \r\n                        that.sku = productSku;\r\n                        that.price = productOpts.in_stock ? productOpts.price : null;\r\n                        that.discount = productOpts.discount;\r\n                        that.productVariants = res;\r\n                        \r\n                        // set size\r\n                        if ( productOpts.size ) {                             \r\n                            Vue.set(that.attributes, 'size', {\r\n                                current : productOpts.size.value,\r\n                                all : [productOpts.size]\r\n                            })\r\n                        }\r\n                        \r\n                        // set color\r\n                        if ( productOpts.color ) {\r\n                            productOpts.color.active = true;\r\n                            productOpts.color.value_2 = (productOpts.color.value_2 || productOpts.color.value);\r\n                            Vue.set(that.attributes, 'color', {\r\n                                current : productOpts.color.id,\r\n                                all : [productOpts.color]\r\n                            })\r\n                        }\r\n                        \r\n                        // set main image\r\n                        if ( productOpts.sku_image ) {\r\n                            \r\n                            var picId = ( productOpts.color ? 'color_' + productOpts.color.id : 'pic_0' ); \r\n                            \r\n                            Vue.set(that.slideshow.pictures, picId, {\r\n                                slideIndex : 0,\r\n                                name: productOpts.sku_image.color ? productOpts.sku_image.color.name : '',\r\n                                image: productOpts.sku_image\r\n                            });\r\n                        }\r\n                    }\r\n                    \r\n                }).then(function(){\r\n                    that.$forceUpdate();\r\n                    if ( that.attributes.color.all ) {\r\n                        that.setAttribute( that.attributes.color.all[0], 'color');\r\n                    }\r\n                    that.slideshow.obj.show(0);\r\n                });\r\n\r\n            },\r\n            quantityChange : function(old, q) {\r\n                 this.quantity = q;\r\n            },\r\n            getAttrClass : function( attr, attrName ) {\r\n                if ( ! attr.active ) return 'uk-disabled';\r\n                if ( this.attributes[attrName].current == attr.id ) return 'uk-active';\r\n            },\r\n            updateData : function() {\r\n\r\n                this.sku = null;\r\n                this.price = null;\r\n                \r\n                // set first availible attribute if not exist\r\n                for ( name in this.attributes ) {\r\n\r\n                    if ( this.attributes[name].current ) continue;\r\n\r\n                    for ( index in this.attributes[name].all ) {\r\n\r\n                        if ( this.attributes[name].all[index].active ) {\r\n\r\n                            this.attributes[name].current = this.attributes[name].all[index].id;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // find product\r\n                for ( sku in this.productVariants ) {\r\n\r\n                    var fits = true;\r\n\r\n                    for ( name in this.attributes ) {\r\n                        \r\n                        // skip attributes, not availible in product\r\n                        if ( ! this.productVariants[sku][name] ) continue;\r\n                        \r\n                        if ( this.attributes[name].current != this.productVariants[sku][name].id ) fits = false;\r\n                    }\r\n\r\n                    if ( fits ) {\r\n\r\n                        this.sku = sku;\r\n                        this.price = this.productVariants[sku].price;\r\n                        this.discount = this.productVariants[sku].discount;\r\n                        this.max = this.productVariants[sku].stock_level;\r\n                    }\r\n                }\r\n            },\r\n            setAttribute : function( attr, attrName ) {\r\n\r\n                // set image\r\n                if ( attrName == 'color' && this.slideshow.obj ) {\r\n\r\n                    var picId = 'color_' + attr.id;\r\n                    if ( this.slideshow.pictures.hasOwnProperty(picId) ) this.slideshow.obj.show( this.slideshow.pictures[picId].slideIndex );\r\n                }\r\n\r\n                if ( ! attr.active ) return false;\r\n\r\n                this.attributes[attrName].current = attr.id;\r\n\r\n                // check if dependency attributes active\r\n                for ( name in this.attributes ) {\r\n\r\n                    if ( name == attrName || name == 'color' ) continue;\r\n\r\n                    var activeAtts = [];\r\n\r\n                    for ( sku in this.productVariants ) {\r\n                        \r\n                        // check only attributes that exist\r\n                        if ( ! this.productVariants[sku][name] ) continue;\r\n                        \r\n                        if ( this.productVariants[sku][attrName].id == attr.id &&\r\n                             this.productVariants[sku].in_stock ) {\r\n                                                        \r\n                            activeAtts.push( this.productVariants[sku][name].id );\r\n                        }\r\n                    }                                               \r\n\r\n                    for ( index in this.attributes[name].all ) {\r\n\r\n                        var att = this.attributes[name].all[index]; \r\n\r\n                        att.active = false;\r\n\r\n                        for ( i=0; i<activeAtts.length; i++) {\r\n                            if ( att.id == activeAtts[i] ) att.active = true;\r\n                        }\r\n\r\n                        // reset active attribute if disabled\r\n                        if ( this.attributes[name].current == att.id && ! att.active ) {\r\n\r\n                            this.attributes[name].current = activeAtts[0] || null;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // reset data\r\n                this.updateData();\r\n            },\r\n            addToCart : function() {\r\n                \r\n                if ( ! this.price ) {\r\n                    \r\n                    UIkit.notification({\r\n                        status : 'warning',\r\n                        message : ffuShop.translation[ffuShop.translation.lang].addToCart.notSelected\r\n                    });\r\n                    return;\r\n                }\r\n                \r\n                var that = this,\r\n                    product = {},\r\n                    variant = this.productVariants[this.sku],\r\n                    notify;\r\n\r\n                if ( variant ) {\r\n\r\n                    product = {\r\n                        id: variant.sku_id,\r\n                        name : that.name,\r\n                        qty: that.quantity,\r\n                        price: variant.price,                        \r\n                        options: {\r\n                            product_id: that.id,\r\n                            discount: variant.discount,\r\n                            sku: that.sku ? that.sku : null,\r\n                            size: variant.size ? variant.size : null,\r\n                            color_name: variant.color ? variant.color.name : null,\r\n                            color_value: variant.color ? variant.color.value : null,\r\n                            color_value_2: variant.color ? variant.color.value_2 : null,\r\n                            image: variant.sku_image ? variant.sku_image : null\r\n                        }\r\n                    };\r\n\r\n                    this.$store.dispatch('addProduct', product);\r\n\r\n                } else {\r\n\r\n                    UIkit.notification({\r\n                        status: 'danger',\r\n                        message: '<span uk-icon=\"icon: ban\"></span> ' + ffuShop.translation[ ffuShop.translation.lang ].addToCart.notSelected\r\n                    });\r\n                }\r\n            }\r\n        },\r\n        created : function() {  \r\n            this.id = $('#fsProductSingle').data('product-id');\r\n            this.name = $('#fsProductSingleName').text();\r\n            this.getProductVariants();\r\n        },\r\n        mounted : function() {            \r\n            this.slideshow.obj = UIkit.slideshow( '#fsProductSingle .fs-product-gallery > .uk-slideshow', {ratio: '1:1'});\r\n        }\r\n    })\r\n};\r\n    \r\n    /*\r\n *  ------------------ User account instance ----------------\r\n */\r\n\r\n// translations\r\nvar lang = ffuShop.translation.lang,\r\n    userAccountLang = {            \r\n        ua : {\r\n            male : 'Чоловіча',\r\n            female : 'Жіноча',\r\n            noEmail : 'Поле email обов`язкове',\r\n            badEmail : 'Невiний Email',\r\n            noPhone : 'Поле телефон обов`язкове',\r\n            badPhone : 'Невiний телефон',\r\n            noNames : 'Прізвище та ім`я обов`язкові',\r\n            passMissMatch : 'Повтор пароля не співпадає з новим паролем',\r\n            emptyFields : 'Всі поля обов`язкові',\r\n            userSaved : 'Данi збережено'\r\n        },\r\n        en : {\r\n            male : 'Male',\r\n            female : 'Female',\r\n            noEmail : 'Email address is required',\r\n            badEmail : 'Email is wrong',\r\n            noPhone : 'Phone is required',\r\n            badPhone : 'Phone format is wrong',\r\n            noNames : 'Your full name is required',\r\n            passMissMatch : 'Repeated password do not match new password',\r\n            emptyFields : 'All passwords are required',\r\n            userSaved : 'Information saved'\r\n        }\r\n    }\r\n\r\n\r\nif ( $('#fsUserAccount').length ) {\r\n\r\n    // datepicker config\r\n    if ( lang == 'ua' ) {\r\n        jQuery.datepicker.setDefaults({\r\n            dayNamesMin: ['Нд', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'],\r\n            monthNamesShort: ['Січень', 'Лютий', 'Березень', 'Квітень', 'Травень', 'Червень', 'Липень', 'Серпень', 'Вересень', 'Жовтень', 'Листопад', 'Грудень']\r\n        });\r\n    }\r\n    \r\n    ffuShop.userAccount = new Vue({\r\n        el: '#fsUserAccount',\r\n        store: ffuShop.store,\r\n        data: function() {\r\n            \r\n            return {\r\n                page: 0,\r\n                editing: false,\r\n                editedFields: {},\r\n                orders: null,\r\n                password: {\r\n                    old : {\r\n                        val : '',\r\n                        type : 'password',\r\n                    },\r\n                    new : {\r\n                        val : '',\r\n                        type : 'password',\r\n                    },\r\n                    repeat : {\r\n                        val : '',\r\n                        class : '',\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        computed: {            \r\n            user : function() {                \r\n                return this.$store.getters.user;\r\n            },\r\n            sexTranslated : function() {\r\n                if ( this.user.sex == 'male' ) {\r\n                    return userAccountLang[lang].male;\r\n                } else if ( this.user.sex == 'female' ) {\r\n                    return userAccountLang[lang].female\r\n                } else {\r\n                    return '';\r\n                }\r\n            },            \r\n            discountPrice : function( product ) {                \r\n                if ( ! this.orders ) return;\r\n                \r\n                var discountPrice = [];\r\n                this.orders.forEach(function( order, i ){\r\n                    discountPrice[i] = [];\r\n                    order.products.forEach(function( product, j ){\r\n                        if ( ! product.discount ) {\r\n                            discountPrice[i][j] = product.price;\r\n                        } else {\r\n                            var price = parseInt( product.price ),\r\n                                disc = parseInt( product.discount );\r\n                            discountPrice[i][j] = Math.round(price * (1+disc/100));\r\n                        }\r\n                    })\r\n                });\r\n                return discountPrice;\r\n            },            \r\n            orderTotal : function( products ) {                \r\n                if ( ! this.orders ) return;\r\n                \r\n                var totals = [],\r\n                    self = this;\r\n                this.orders.forEach(function( order, i ){\r\n                    var total = 0;\r\n                    order.products.forEach(function( product, j ){\r\n                        total += parseInt(product.qty) * self.discountPrice[i][j]\r\n                    });\r\n                    totals[i] = total + parseInt(order.delivery.cost);\r\n                })\r\n                return totals;\r\n            }\r\n        },\r\n        methods: {            \r\n            transBeforeEnter : function(el) {\r\n                el.style.display = 'none';\r\n            },\r\n            transEnter : function(el, done) {\r\n                var that = this;\r\n                $(el).delay(300).slideDown(function(){                    \r\n                    UIkit.update(event = 'update');                  \r\n                    done();\r\n                });\r\n            },\r\n            transLeave : function(el, done) {\r\n                $(el).slideUp(done);\r\n            },\r\n            setPage : function(num) {\r\n                if ( ! this.editing ) this.page = num;\r\n            },\r\n            \r\n            // User editing methods\r\n            \r\n            setNewValue : function(e) {\r\n                //console.log( e.target.name, e.target.value );\r\n                var name = e.target.name,\r\n                    value = e.target.value;\r\n                \r\n                Vue.set( this.editedFields, name, value );\r\n            },\r\n            saveUserData : function() {\r\n                \r\n                if ( $.isEmptyObject(this.editedFields) ) this.editing = false; \r\n                \r\n                var valid = true;\r\n                \r\n                // check names\r\n                if ( ('first_name' in this.editedFields) ||\r\n                     ('last_name' in this.editedFields) ) {\r\n                    \r\n                    if ( ! (this.editedFields.first_name &&\r\n                           this.editedFields.first_name) ) {\r\n                        \r\n                        valid = false;                        \r\n                        UIkit.notification({\r\n                            message: userAccountLang[lang].noNames,\r\n                            status: 'danger'\r\n                        })\r\n                    }\r\n                }\r\n                \r\n                // check email\r\n                if ( ('email' in this.editedFields) &&\r\n                     ! (/^([\\w.*-]+@([\\w-]+\\.)+[\\w-]{2,4})$/).test(this.editedFields.email) ) {\r\n                    \r\n                    valid = false;\r\n                    var msgText = userAccountLang[lang][ this.editedFields.email.length ? 'badEmail' : 'noEmail' ];\r\n                    UIkit.notification({\r\n                        message: msgText,\r\n                        status: 'danger'\r\n                    })\r\n                }\r\n                \r\n                // check phone\r\n                if ( ('phone' in this.editedFields) &&\r\n                     ! (/\\+38\\([0-9]{3}\\)[0-9]{3}-[0-9]{2}-[0-9]{2}/).test(this.editedFields.phone) ) {\r\n                    valid = false;\r\n                    var msgText = userAccountLang[lang][ this.editedFields.phone.length ? 'badPhone' : 'noPhone' ];\r\n                    UIkit.notification({\r\n                        message: msgText,\r\n                        status: 'danger'\r\n                    })\r\n                }\r\n                \r\n                if ( valid ) {\r\n                    \r\n                    var self = this;                    \r\n                    this.$store.dispatch('saveUser', this.editedFields).then(function(){\r\n                        self.editing = false;\r\n                        UIkit.notification({\r\n                            status : 'success',\r\n                            message : userAccountLang[lang].userSaved\r\n                        });\r\n                    }).catch(function(err){\r\n                        console.log(err);\r\n                        UIkit.notification({\r\n                            status : 'danger',\r\n                            message : ffuShop.helpers.createErrorMsg( err.errors )\r\n                        });\r\n                    })\r\n                }\r\n            },\r\n            \r\n            \r\n            // Pasword change\r\n            \r\n            changeView : function( field ) {\r\n                \r\n                var type = this.password[field].type;\r\n                this.password[field].type = ( type == 'password' ? 'text' : 'password' );\r\n            },\r\n            \r\n            repeatPassClass : function() {\r\n                \r\n                this.password.repeat.class = ( this.password.new.val != this.password.repeat.val ? 'uk-form-danger' : 'uk-form-success' );\r\n            },\r\n            \r\n            resetRepeatPassClass : function() {\r\n                \r\n                this.password.repeat.class = '';\r\n            },\r\n            \r\n            changePassword : function() {\r\n                   \r\n                if ( ! this.password.old.val ||\r\n                     ! this.password.new.val ||\r\n                     ! this.password.repeat.val ) {\r\n                    \r\n                    UIkit.notification({\r\n                        status : 'warning',\r\n                        message : userAccountLang[lang].emptyFields\r\n                    });\r\n                    \r\n                } else if ( this.password.new.val !== this.password.repeat.val ) {\r\n                    \r\n                    UIkit.notification({\r\n                        status : 'warning',\r\n                        message : userAccountLang[lang].passMissMatch\r\n                    });\r\n                    \r\n                } else {\r\n                    \r\n                    var self = this;\r\n                    var data = {\r\n                        old_password : this.password.old.val,\r\n                        new_password : this.password.new.val\r\n                    };\r\n\r\n                    $.ajax({\r\n                        url : ffuShop.routes.user.changePass.url,\r\n                        type : ffuShop.routes.user.changePass.req,\r\n                        dataType : 'json',\r\n                        data : data,\r\n                        success : function(res){\r\n                            var status, message = '';\r\n                            if ( res.errors &&\r\n                                 ! $.isEmptyObject(res.errors) ) {\r\n                                status = 'danger';\r\n                                message = ffuShop.helpers.createErrorMsg( res.errors );\r\n                            } else {\r\n                                status = 'success';\r\n                                message = res.message;\r\n                                for ( p in self.password ) {\r\n                                    self.password[p].val = '';\r\n                                }\r\n                            }\r\n                            UIkit.notification({\r\n                                status : status,\r\n                                message : message\r\n                            });\r\n                        }\r\n                    })\r\n                }\r\n            },\r\n            \r\n            \r\n            // Orders\r\n            \r\n            getOrders : function() {\r\n                \r\n                var that = this;\r\n                \r\n                $.ajax({\r\n                    url: ffuShop.routes.orders.all.url,\r\n                    type: ffuShop.routes.orders.all.req,\r\n                    dataType: 'json',\r\n                    success: function(res){\r\n                        if ( ! res || res.length == 0 ) return;\r\n                        if ( res.errors &&\r\n                             ! $.isEmptyObject(res.errors) ) {\r\n                            UIkit.notification({\r\n                                status : 'danger',\r\n                                message : ffuShop.helpers.createErrorMsg( res.errors )\r\n                            });\r\n                        } else {\r\n                            that.orders = res;\r\n                        }                            \r\n                    }\r\n                })\r\n            }\r\n        },\r\n        watch: {\r\n            \r\n            editing: function(isEditing) {\r\n                \r\n                if ( isEditing ) {\r\n                    \r\n                    var that = this;                    \r\n                    var dpInt = setInterval(function(){\r\n                        \r\n                        if ( ! that.$refs.birthday && that.$refs.phone ) return;\r\n                        \r\n                        clearInterval(dpInt);\r\n                                                                        \r\n                        // create datepicher\r\n                        $(that.$refs.birthday)\r\n                            .datepicker({\r\n                                changeMonth: true,\r\n                                changeYear: true,\r\n                                dateFormat: 'dd/mm/yy',\r\n                                firstDay: 1,\r\n                                maxDate: 0,\r\n                            })\r\n                            .on('change', ffuShop.helpers.nativeChange);\r\n                        \r\n                        // create phone mask\r\n                        $(that.$refs.phone)\r\n                            .mask('+38(999)999-99-99')\r\n                            .on('change', ffuShop.helpers.nativeChange);\r\n                        \r\n                    }, 200)\r\n                }\r\n            },\r\n            \r\n            page: function( page ) {\r\n                \r\n                if ( this.orders !== null ) return;\r\n                \r\n                if ( page == 2 ) this.getOrders();\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\n})"]}