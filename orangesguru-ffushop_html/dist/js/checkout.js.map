{"version":3,"sources":["checkout.js"],"names":["jQuery","document","ready","$","lang","ffuShop","translation","userInfoCheckout","ua","first_namePlaceholder","last_namePlaceholder","emailPlaceholder","phonePlaceholder","en","Vue","component","store","data","fields","first_name","type","placeholder","required","valid","pattern","RegExp","last_name","email","phone","computed","fieldValues","this","$store","state","user","created","validate","updated","methods","setField","e","fieldName","target","name","fieldValue","value","oldval","replace","substring","i","length","match","commit","filedValid","field","test","template","deliveryCourierLang","title","placeholderStr","placeholderBld","placeholderApt","cost","options","addressStr","addressBld","addressApt","details","props","isActive","Boolean","providerName","wrapClass","isValid","set","deliveryProviders","errorClass","deliveryDetails","checkField","push","deliveryNewPostLang","buttonText","detailsPrefix","noCityErr","city","department","warehouse","gmapsScript","newPostStyles","append","deliveryData","mounted","newPostScript","getDetails","console","log","on","setDetails","id","val","text","ajax","routes","cart","getNPDeliveryPrice","req","url","dataType","productsQuantity","checkout","cartTotal","quantity","productsCost","products","success","res","price","next","off","click","UIkit","notification","message","status","beforeDestroy","NPWidgetMap","remove","deliverySelfLang","redirect","el","page","scrollEl","scroll","offset","duration","active","getters","delivery","payment","isDeliveryValid","deliveryValid","q","sum","p","qty","discountPrice","deliveryCost","providers","summ","Math","round","transBeforeEnter","style","display","transEnter","done","that","delay","slideDown","update","event","offsetHeight","window","innerHeight","scrollTo","$el","transLeave","slideUp","quantityChange","oldnum","num","rowId","removeProduct","payload","self","dispatch","then","subtotal","catch","errMsg","finally","removeCart","confirm","modal","labels","ok","cancel","setPage","index","hard","navClass","setDeliveryProvider","setPaymentProvider","registerUser","extend","provider","Promise","resolve","reject","isEmptyObject","errors","is_active","error","err","helpers","errorReject","validateDelivery","processDeliveryValidation","noDelivery","removeClass","setTimeout","addClass","registered","errorHandler","noUser","validatePayment","confirmOrder","order","deliveryDetailsWarehouse","action","location","href","form","appendTo","submit"],"mappings":"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","file":"checkout.js","sourcesContent":["jQuery(document).ready(function($){\r\n        \r\n    /*\r\n     * Delivery tab\r\n     */\r\n    \r\n    /*\r\n *  ------------------ User form in checkout ----------------\r\n */\r\n\r\n// translations\r\nvar lang = ffuShop.translation.lang;\r\n\r\nffuShop.translation.userInfoCheckout = {            \r\n    ua : {\r\n        first_namePlaceholder : 'Ваше iм`я',\r\n        last_namePlaceholder : 'Ваше прізвище',\r\n        emailPlaceholder : 'Ваш e-mail',\r\n        phonePlaceholder : 'Ваш телефон'\r\n    },\r\n    en : {\r\n        first_namePlaceholder : 'Your First Name',\r\n        last_namePlaceholder : 'Your Last Name',\r\n        emailPlaceholder : 'Your E-mail',\r\n        phonePlaceholder : 'Your Phone'\r\n    }\r\n}\r\n\r\n// component description\r\nVue.component('user-info-checkout', {\r\n    store : ffuShop.store,\r\n    data : function() {\r\n        return {\r\n            fields : {\r\n                first_name : {\r\n                    type : 'text',\r\n                    placeholder : ffuShop.translation.userInfoCheckout[lang].first_namePlaceholder,\r\n                    required : true,\r\n                    valid : false,\r\n                    pattern : new RegExp('^[a-zа-я ,.\\'-]+$', 'i')\r\n                },\r\n                last_name : {\r\n                    type : 'text',\r\n                    placeholder : ffuShop.translation.userInfoCheckout[lang].last_namePlaceholder,\r\n                    required : false,\r\n                    valid : true,\r\n                },\r\n                email : {\r\n                    type : 'email',\r\n                    placeholder : ffuShop.translation.userInfoCheckout[lang].emailPlaceholder,\r\n                    required : true,\r\n                    valid : false,\r\n                    pattern : new RegExp(/^([\\w.*-]+@([\\w-]+\\.)+[\\w-]{2,4})$/)\r\n                    \r\n                },\r\n                phone : {\r\n                    type : 'tel',\r\n                    placeholder : ffuShop.translation.userInfoCheckout[lang].phonePlaceholder,\r\n                    required : true,\r\n                    valid : false,\r\n                    pattern : new RegExp('\\\\+38\\\\([0-9]{3}\\\\)[0-9]{3}-[0-9]{2}-[0-9]{2}')\r\n                }\r\n            }\r\n        }\r\n    },\r\n    computed : {        \r\n        fieldValues : function() {\r\n            return {\r\n                first_name : this.$store.state.user.first_name,\r\n                last_name : this.$store.state.user.last_name,\r\n                email : this.$store.state.user.email,\r\n                phone : this.$store.state.user.phone\r\n            }\r\n        },\r\n        user : function() {\r\n            return this.$store.state.user;\r\n        },\r\n    },\r\n    created : this.validate,\r\n    updated : this.validate,\r\n    methods : {\r\n        setField : function(e) {\r\n            var fieldName = e.target.name,\r\n                fieldValue = e.target.value;\r\n            \r\n            // filter phone            \r\n            if ( fieldName == 'phone' ) {\r\n                \r\n                var phone = '+38(0',\r\n                    oldval = fieldValue;\r\n                \r\n                fieldValue = fieldValue.replace(/\\D/g, ''); // remove not digits\r\n                fieldValue = fieldValue.replace(/^(380|38|3)/, ''); // remove 38 in beginning\r\n                fieldValue = fieldValue.substring(0,9); // crop number\r\n                for (var i=0; i<fieldValue.length; i++) {\r\n                    phone += fieldValue[i] + ( i == 1 ? ')' : '');\r\n                    phone += ( i == 4 || i == 6 ? '-' : '');\r\n                }\r\n                // chech deleting symbol\r\n                if ( oldval.length < phone.length\r\n                     && phone[phone.length-1].match(/\\D/) ) {\r\n                    phone = phone.substring(0, phone.length - 1);\r\n                }\r\n                fieldValue = phone;\r\n                e.target.value = phone;\r\n            }                    \r\n            \r\n            this.$store.commit('setUserInfo', [ fieldName, fieldValue ]);\r\n            this.validate();\r\n        },\r\n        \r\n        filedValid : function(fieldName) {\r\n            \r\n            var field = this.fields[fieldName],\r\n                value = this.fieldValues[fieldName],\r\n                valid = true;\r\n                            \r\n            // check required\r\n            if ( field.required && ! value ) {\r\n                valid = false;  \r\n            }\r\n            // check pattern\r\n            if ( field.pattern && ! field.pattern.test(value) ) {\r\n                valid = false;\r\n            }\r\n            \r\n            return valid;\r\n        },\r\n        \r\n        validate : function() {\r\n            \r\n            var valid = true;\r\n            \r\n            for ( field in this.fields ) {\r\n                \r\n                valid = valid && this.filedValid(field);\r\n            }\r\n            \r\n            this.$store.commit('setUserInfo', ['valid', valid ]);\r\n        }\r\n    },\r\n    template : '<form action=\"\" class=\"uk-grid-small uk-child-width-1-2@s uk-child-width-1-4@l\" uk-grid>\\\r\n        <div v-for=\"(field, name) in fields\" :key=\"name\">\\\r\n            <input  :type=\"field.type\"\\\r\n                    :name=\"name\"\\\r\n                    class=\"uk-input\"\\\r\n                    :class=\"{\\'uk-form-danger\\': ! filedValid(name)}\"\\\r\n                    :disabled=\"user.registered\"\\\r\n                    :placeholder=\"field.placeholder + (field.required ? \\' *\\' : \\'\\')\"\\\r\n                    :value=\"fieldValues[name]\"\\\r\n                    @input=\"setField\">\\\r\n        </div>\\\r\n    </form>'\r\n});\r\n    \r\n    /*\r\n *  ------------------ Courier delivery component ----------------\r\n */\r\n\r\n// translations\r\nvar lang = ffuShop.translation.lang,\r\n    deliveryCourierLang = {            \r\n        ua : {\r\n            title : 'Кур\\'єрська доставка по м. Києву',\r\n            placeholderStr : 'вул./пров./пл.',\r\n            placeholderBld : 'дім',\r\n            placeholderApt : 'кв',\r\n        },\r\n        en : {\r\n            title : 'Courier Delivery in Kiev',\r\n            placeholderStr : 'str./sq.',\r\n            placeholderBld : 'bld.',\r\n            placeholderApt : 'apt.',\r\n        }\r\n    }\r\n\r\n// register provider    \r\nffuShop.store.commit('createDeliveryProvider', ['courier', {       \r\n    component : 'courier-delivery',\r\n    title : deliveryCourierLang[lang].title,                   \r\n    cost : 100,\r\n    options : {\r\n        addressStr : null,\r\n        addressBld : null,\r\n        addressApt : null,\r\n        details : [deliveryCourierLang[lang].title]\r\n    },\r\n    valid : false\r\n}]);\r\n\r\n// component description\r\nVue.component('courier-delivery', {\r\n    props : {\r\n        isActive : {\r\n            type : Boolean,\r\n            required : true\r\n        }\r\n    },\r\n    store : ffuShop.store,        \r\n    data : function() {\r\n        return {\r\n            providerName : 'courier',                                \r\n            fields : {\r\n                addressStr : {\r\n                    wrapClass : 'uk-width-expand@s',\r\n                    placeholder : deliveryCourierLang[lang].placeholderStr,\r\n                    required : true,\r\n                    valid : false\r\n                },\r\n                addressBld : {\r\n                    wrapClass : 'uk-width-1-2 uk-width-small@s',\r\n                    placeholder : deliveryCourierLang[lang].placeholderBld,\r\n                    required : true,\r\n                    valid : false\r\n                },\r\n                addressApt : {\r\n                    wrapClass : 'uk-width-1-2 uk-width-small@s',\r\n                    placeholder : deliveryCourierLang[lang].placeholderApt,\r\n                    required : true,\r\n                    valid : false\r\n                }\r\n            }\r\n        }\r\n    },\r\n    computed : {\r\n        isValid : function() {\r\n            var valid = true;\r\n            for ( field in this.fields ) {\r\n                if ( this.fields[field].required && ! this.fieldValues[field] ) {\r\n                    valid = false;\r\n                    Vue.set( this.fields[field], 'valid', false );\r\n                } else {\r\n                    Vue.set( this.fields[field], 'valid', true );\r\n                }\r\n            };\r\n            return valid;\r\n        },\r\n        fieldValues : function() {\r\n            return this.$store.state.deliveryProviders[ this.providerName ].options;\r\n        }        \r\n    },\r\n    created : this.validate,\r\n    updated : this.validate,\r\n    methods : {\r\n        errorClass : function(field) {\r\n            if ( ! this.isActive ) return '';\r\n            return (field.valid ? '' : 'uk-form-danger');\r\n        },\r\n        deliveryDetails : function() {\r\n            var details = '';\r\n            for (i in this.fields ) {\r\n                details += ( details.length ? ', ' : '');\r\n                details += this.fields[i].placeholder + ' ' + this.fieldValues[i];\r\n            }\r\n            return details;\r\n        },\r\n        checkField : function(e) {                \r\n            var fieldName = e.target.name,\r\n                fieldValue = e.target.value;\r\n\r\n            this.$store.commit('setDeliveryProviderField', [\r\n                this.providerName,\r\n                fieldName,\r\n                fieldValue\r\n            ]);\r\n            \r\n            var details = [deliveryCourierLang[lang].title];\r\n                details.push( this.deliveryDetails() );\r\n            this.$store.commit('setDeliveryProviderField', [\r\n                this.providerName,\r\n                'details',\r\n                details\r\n            ]); \r\n            \r\n            this.validate();\r\n        },\r\n        validate : function() {\r\n            this.$store.commit('setDeliveryProviderValid', [\r\n                this.providerName,\r\n                this.isValid\r\n            ]);\r\n        }\r\n    },\r\n    template : '<form action=\"\" uk-grid>\\\r\n                    <div v-for=\"(field, fieldName) in fields\"\\\r\n                         :key=\"fieldName\"\\\r\n                         :class=\"field.wrapClass\">\\\r\n                         <input type=\"text\" class=\"uk-input\"\\\r\n                                :class=\"errorClass(field)\"\\\r\n                                :value=\"fieldValues[fieldName]\"\\\r\n                                :name=\"fieldName\"\\\r\n                                :placeholder=\"field.placeholder\"\\\r\n                                @input=\"checkField\">\\\r\n                    </div>\\\r\n                </form>'\r\n});\r\n    \r\n    /*\r\n *  ------------------ New Post delivery component ----------------\r\n */\r\n\r\n// translations\r\nvar lang = ffuShop.translation.lang,\r\n    deliveryNewPostLang = {            \r\n        ua : {\r\n            title : 'Нова Пошта',\r\n            buttonText : 'Оберіть номер відділення',\r\n            detailsPrefix : 'Україна, м. ',\r\n            noCityErr : 'Оберiть мicто зi списку мiст'\r\n        },\r\n        en : {\r\n            title : 'Nova Poshta',\r\n            buttonText : 'Choose Department',\r\n            detailsPrefix : 'Ukraine, м. ',\r\n            noCityErr : 'Choose city from list'\r\n        }\r\n    }\r\n\r\n// register provider    \r\nffuShop.store.commit('createDeliveryProvider', ['new-post', {       \r\n    component : 'new-post-delivery',\r\n    title : deliveryNewPostLang[lang].title,                   \r\n    cost : 75,\r\n    options : {\r\n        city : null,\r\n        department : null,\r\n        warehouse: null,\r\n        details : [deliveryNewPostLang[lang].title]\r\n    },\r\n    valid : false,\r\n}]);\r\n\r\njQuery(document).ready(function($){\r\n    \r\n    // install scripts and styles\r\n    var gmapsScript = $('<script async=\"\" defer=\"\" src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyAPhm7Q29X5ldwjLtA7IMYHU_0xATiWK3A&amp;language=ua\">');    \r\n    var newPostStyles = $('<link rel=\"stylesheet\" href=\"https://apimgmtstorelinmtekiynqw.blob.core.windows.net/content/MediaLibrary/Widget/Map/styles/map.css\">');\r\n    $('head').append(newPostStyles);\r\n    $('body').append(gmapsScript);\r\n    \r\n})\r\n\r\n\r\n// component description\r\nVue.component('new-post-delivery', {\r\n    props : {\r\n        isActive : {\r\n            type : Boolean,\r\n            required : true\r\n        }\r\n    },\r\n    data : function() {\r\n        return {\r\n            providerName : 'new-post',\r\n            fields : {\r\n                city : {\r\n                    required : true\r\n                },\r\n                department : {\r\n                    required : true\r\n                },\r\n                warehouse: {\r\n                    required : true\r\n                },\r\n\r\n            },\r\n            buttonText : deliveryNewPostLang[lang].buttonText\r\n        }\r\n    },\r\n    computed : {\r\n        deliveryData : function() {\r\n            return this.$store.state.deliveryProviders[ this.providerName ].options\r\n        },\r\n        department : function() {\r\n            if ( this.deliveryData.city && this.deliveryData.department ) {\r\n                return this.deliveryData.city + ', ' + this.deliveryData.department;\r\n            } else { return ''; }\r\n        },\r\n        isValid : function() {\r\n            var valid = true;            \r\n            for ( field in this.fields ) {\r\n                if ( this.fields[field].required && ! this.deliveryData[field] ) {\r\n                    valid = false;\r\n                }\r\n            };\r\n            return valid;\r\n        }\r\n    },\r\n    mounted : function() {\r\n        \r\n        var newPostScript = $('<script type=\"text/javascript\" id=\"map\" charset=\"utf-8\" data-lang=\"ua\" apiKey=\"597859b7955dc05b6595d86bd6fc96fc\" data-town=\"undefined\" data-town-name=\"undefined\" data-town-id=\"undefined\" src=\"https://apimgmtstorelinmtekiynqw.blob.core.windows.net/content/MediaLibrary/Widget/Map/dist/map.min.js\">');\r\n        $('body').append(newPostScript);\r\n        \r\n        function getDetails() {\r\n            console.log('get details');\r\n            function setDetails(e) {\r\n                \r\n                if ( e.target.id == 'npw-map-close-button' ) {\r\n                    \r\n                    $('#npw-map-wrapper').off('click', setDetails);\r\n                    return;\r\n                }\r\n                \r\n                var department = $('#npw-map-state-details .npw-details-title');\r\n                var city = $('#npw-cities').val();\r\n\r\n\r\n                if ( department.text() != '' && city !== null  ) {\r\n\r\n                    $.ajax({\r\n                        type:ffuShop.routes.cart.getNPDeliveryPrice.req,\r\n                        url: ffuShop.routes.cart.getNPDeliveryPrice.url,\r\n                        dataType: 'json',\r\n                        data:{  city: city ,\r\n                            department: department.text(),\r\n                            productsQuantity : ffuShop.checkout.cartTotal.quantity,\r\n                            productsCost: ffuShop.checkout.cartTotal.products\r\n                        },\r\n                        success: function(res){\r\n                            //console.log(res);\r\n                            ffuShop.store.commit('setDeliveryProviderCost', [\r\n                                'new-post',\r\n                                res.price\r\n                            ]);\r\n                            ffuShop.store.commit('setDeliveryProviderField', [\r\n                                'new-post',\r\n                                'warehouse',\r\n                                res.warehouse\r\n                            ]);\r\n                            ffuShop.store.commit('setDeliveryProviderField', [\r\n                                'new-post',\r\n                                'details',\r\n                                [deliveryNewPostLang[lang].detailsPrefix + city, department.next().text()]\r\n                            ]);\r\n                        }\r\n                    });\r\n\r\n                    ffuShop.store.commit('setDeliveryProviderField', [\r\n                        'new-post',\r\n                        'city',\r\n                        city\r\n                    ]);\r\n                    ffuShop.store.commit('setDeliveryProviderField', [\r\n                        'new-post',\r\n                        'department',\r\n                        department.text()\r\n                    ]);\r\n\r\n                    ffuShop.store.commit('setDeliveryProviderValid', [\r\n                        'new-post',\r\n                        true\r\n                    ]);\r\n\r\n                    $('#npw-map-wrapper').off('click', setDetails);\r\n                    $('#npw-map-close-button').click();\r\n\r\n                } else {\r\n                    \r\n                    ffuShop.store.commit('setDeliveryProviderField', [\r\n                        'new-post',\r\n                        'city',\r\n                        ''\r\n                    ]);\r\n                    ffuShop.store.commit('setDeliveryProviderField', [\r\n                        'new-post',\r\n                        'department',\r\n                        ''\r\n                    ]);\r\n                    ffuShop.store.commit('setDeliveryProviderField', [\r\n                        'new-post',\r\n                        'details',\r\n                        []\r\n                    ]);\r\n                    ffuShop.store.commit('setDeliveryProviderValid', [\r\n                        'new-post',\r\n                        false\r\n                    ]);\r\n                    \r\n                    if ( city == null ) {\r\n                        UIkit.notification({\r\n                            message : deliveryNewPostLang[lang].noCityErr,\r\n                            status : 'danger'\r\n                        })\r\n                    }\r\n                }\r\n            }\r\n                \r\n            $('#npw-map-wrapper').on('click', setDetails);\r\n        }\r\n\r\n        $('#fsCheckout').on('click', '#npw-map-open-button', getDetails);\r\n\r\n        $('#fsCheckout').on('click', '#npw-map-close-button', function(){\r\n            $('#npw-map-wrapper').off('click', setDetails);\r\n            $('#fsCheckout').off('click', '#npw-map-open-button', getDetails);\r\n        });\r\n    },\r\n    beforeDestroy : function() {\r\n        NPWidgetMap = null;\r\n        $('#map, #npw-map-wrapper').remove();\r\n    },\r\n    created : this.validate,\r\n    updated : this.validate,\r\n    methods : {\r\n        errorClass : function() {\r\n            if ( ! this.isActive ) return 'uk-button-default';\r\n            return (this.isValid ? 'uk-button-default' : 'uk-button-danger');\r\n        },\r\n        validate : function() {\r\n            this.$store.commit('setDeliveryProviderValid', [\r\n                this.providerName,\r\n                this.isValid()\r\n            ]);\r\n        }\r\n    },\r\n    template : '<div id=\"np-map\">\\\r\n                    <button type=\"button\" id=\"npw-map-open-button\" class=\"uk-button\" :class=\"errorClass()\">{{ buttonText }}</button>\\\r\n                    <br class=\"uk-hidden@s\">\\\r\n                    {{ department }}\\\r\n                </div>'\r\n});\r\n    \r\n    /*\r\n    @include('./src/js/Vue/components/DeliveryNewPostNew.js')\r\n     */\r\n\r\n\r\n    /*\r\n *  ------------------ New Post delivery component ----------------\r\n */\r\n\r\n// translations\r\nvar lang = ffuShop.translation.lang,\r\n    deliverySelfLang = {            \r\n        ua : {\r\n            title : 'Самовивіз',\r\n        },\r\n        en : {\r\n            title : 'Self-delivery',\r\n        }\r\n    }\r\n\r\n// register provider    \r\nffuShop.store.commit('createDeliveryProvider', ['self', {       \r\n    component : 'self-delivery',\r\n    title : deliverySelfLang[lang].title,                   \r\n    cost : 0,\r\n    options : {\r\n        details : [deliverySelfLang[lang].title]\r\n    },\r\n    valid : true\r\n}]);\r\n\r\n// component description\r\nVue.component('self-delivery', {\r\n    props : {\r\n        isActive : {\r\n            type : Boolean,\r\n            required : true\r\n        }\r\n    },\r\n    data : function() {\r\n        return {\r\n            providerName : 'self'\r\n        }\r\n    },\r\n    computed : {\r\n        isValid : function() {\r\n            return true;\r\n        },\r\n    },\r\n    created : this.validate,\r\n    updated : this.validate,\r\n    methods : {\r\n        validate : function() {\r\n            this.$store.commit('setDeliveryProviderValid', [\r\n                this.providerName,\r\n                this.isValid\r\n            ]);\r\n        }\r\n    },\r\n    template : '<div></div>'\r\n});\r\n    \r\n    \r\n    /*\r\n     * Payment tab\r\n     */\r\n    \r\n    /*\r\n *  ------------------ Credit card payment ----------------\r\n */\r\n\r\n// translations\r\nvar lang = ffuShop.translation.lang,\r\n    creditCardLang = {            \r\n        ua : {\r\n            title : 'Сплатити онлайн (Visa, Mastercard)',\r\n        },\r\n        en : {\r\n            title : 'Pay online (Visa, Mastercard)',\r\n        }\r\n    }\r\n\r\n// register provider    \r\nffuShop.store.commit('createPaymentProvider', ['credit-card', {    \r\n    title : creditCardLang[lang].title,                   \r\n    cost : 0,\r\n    options : {\r\n        redirect : 'https://www.liqpay.ua/'\r\n    }\r\n}]);\r\n    \r\n    /*\r\n *  ------------------ Cash on delivery payment ----------------\r\n */\r\n\r\n// translations\r\nvar lang = ffuShop.translation.lang,\r\n    cashOnDelivery = {            \r\n        ua : {\r\n            title : 'Наложений платіж',\r\n        },\r\n        en : {\r\n            title : 'Cash On Delivery',\r\n        }\r\n    }\r\n\r\n// register provider    \r\nffuShop.store.commit('createPaymentProvider', ['cash-on-delivery', {    \r\n    title : cashOnDelivery[lang].title,                   \r\n    cost : 34,\r\n    options : {\r\n        redirect : '/thank-you.html'\r\n    }\r\n}]);\r\n    \r\n    \r\n    \r\n    /*\r\n     * Vue instance\r\n     */\r\n    \r\n    ffuShop.checkout = new Vue({\r\n\r\n        el: '#fsCheckout',\r\n        store : ffuShop.store,\r\n        data : {\r\n            page : 0,\r\n            scrollEl : UIkit.scroll('#fsCheckout',{\r\n                offset : 60,\r\n                duration : 300\r\n            }),\r\n            active : true\r\n        },\r\n        computed : {\r\n            products : function() {\r\n                return this.$store.getters.products;\r\n            },\r\n            user : function() {\r\n                return this.$store.state.user;\r\n            },\r\n            delivery : function() {\r\n                return this.$store.getters.delivery;\r\n            },\r\n            deliveryDetails : function() {\r\n                return this.$store.getters.deliveryDetails;\r\n            },\r\n            payment : function() {\r\n                return this.$store.getters.payment;\r\n            },\r\n            isDeliveryValid : function() {\r\n                return this.$store.getters.deliveryValid;\r\n            },\r\n            cartTotal : function(){\r\n                var q = 0, sum = 0,products=0;;\r\n\r\n                for ( p in this.products ) {\r\n                    if ( ! this.products[p].qty ) continue; // check initial state\r\n                    q ++;\r\n                    sum += this.products[p].qty * this.products[p].discountPrice;\r\n                };\r\n\r\n                products = sum;\r\n                // include delivery cost\r\n                if ( this.page > 0 ) sum += this.$store.getters.deliveryCost;\r\n\r\n                // include payment cost\r\n                if ( this.page > 1 ) sum += this.payment.providers[this.payment.active].cost;\r\n\r\n                return { quantity : q, summ : Math.round(sum), products:Math.round(products) };\r\n            }\r\n        },\r\n        methods : {                   \r\n\r\n            transBeforeEnter : function(el) {\r\n                el.style.display = 'none';\r\n            },\r\n            transEnter : function(el, done) {\r\n                var that = this;\r\n                $(el).delay(300).slideDown(function(){\r\n                    UIkit.update(event = 'update');\r\n                    if ( el.offsetHeight > window.innerHeight ) {\r\n                        that.scrollEl.scrollTo(that.$el);\r\n                    }\r\n                    done();\r\n                });\r\n            },\r\n            transLeave : function(el, done) {\r\n                $(el).slideUp(done);\r\n            },\r\n\r\n            quantityChange : function(oldnum, num, rowId) {\r\n                \r\n                if ( oldnum == num && num == 1 ) {\r\n                    \r\n                    this.removeProduct( rowId );\r\n                    \r\n                } else {\r\n                    \r\n                    // set quantity\r\n                    this.active = false;                \r\n                    var payload = [rowId, num],\r\n                        self = this;\r\n\r\n                    this.$store.dispatch('setProductQuantity', payload)\r\n                        .then(function(){\r\n                            self.products[rowId].qty = num;\r\n                            self.products[rowId].subtotal = num * self.products[rowId].price;\r\n                        })\r\n                        .catch(function(errMsg){\r\n                            UIkit.notification({\r\n                                status : 'warning',\r\n                                message : errMsg\r\n                            });\r\n                        })\r\n                        .finally(function(){\r\n                            self.active = true;   \r\n                        })\r\n                }\r\n            },\r\n\r\n            removeProduct : function( rowId ) {\r\n\r\n                var message = ffuShop.translation[ffuShop.translation.lang].removeCart.confirm + this.products[rowId].name + '?';\r\n\r\n                var that = this;\r\n                UIkit.modal.confirm(message,{\r\n                    labels: {\r\n                        ok: ffuShop.translation[ffuShop.translation.lang].removeCart.ok,\r\n                        cancel: ffuShop.translation[ffuShop.translation.lang].removeCart.cancel\r\n                    }\r\n                }).then( function(){\r\n                    that.active = false;\r\n                    that.$store.dispatch('removeProduct', rowId )\r\n                        .finally(function(){\r\n                            that.active = true;\r\n                        });\r\n                }).catch(function(e){\r\n                    if (typeof e == 'object') console.log(e)\r\n                });\r\n            },\r\n\r\n            setPage : function( index, hard ) {\r\n\r\n                if ( !hard && index < this.page ) {\r\n\r\n                    this.page = index;\r\n\r\n                } else if ( hard ) { \r\n\r\n                    this.page = index\r\n                }\r\n            },\r\n\r\n            navClass : function( index ) {\r\n                return index <= this.page ? 'uk-active' : null;\r\n            },\r\n\r\n            setDeliveryProvider : function( index ) {\r\n\r\n                this.$store.commit('setDeliveryProvider', index );\r\n            },\r\n\r\n            setPaymentProvider : function( index ) {\r\n\r\n                this.$store.commit('setPaymentProvider', index );\r\n            },\r\n            \r\n            registerUser : function() {\r\n                \r\n                var user = $.extend({}, this.user),\r\n                    state = this.$store.state;\r\n                \r\n                this.active = false;\r\n                \r\n                user.deliveryProviders = {};                \r\n                for ( name in state.deliveryProviders ) {\r\n                    var provider = state.deliveryProviders[name];\r\n                    user.deliveryProviders[name] = {\r\n                        options : provider.options,\r\n                        valid : provider.valid\r\n                    }\r\n                }\r\n                \r\n                var self = this;\r\n                \r\n                return new Promise(function(resolve, reject){\r\n                    $.ajax({\r\n                        url : ffuShop.routes.cart.registerUser.url,\r\n                        type : ffuShop.routes.cart.registerUser.req,\r\n                        data : user,\r\n                        dataType : 'json',\r\n                        success : function(res) {\r\n                            if ( $.isEmptyObject(res.errors) && res.is_active ) { \r\n                                resolve();\r\n                            } else {\r\n                                reject(res.errors);\r\n                            }\r\n                        },\r\n                        error : function(err, text) {\r\n                            ffuShop.helpers.errorReject(reject, err, text)\r\n                        }\r\n                    })\r\n                })\r\n                .finally(function(){\r\n                    self.active = true;\r\n                })\r\n            },\r\n            \r\n            validateDelivery : function() {\r\n\r\n                var valid = true,\r\n                    self = this,\r\n                    lang = ffuShop.translation.lang;                    \r\n                    \r\n                this.active = false;\r\n                \r\n                function processDeliveryValidation() {\r\n                    \r\n                    if ( ! self.isDeliveryValid ) {\r\n                        UIkit.notification({\r\n                            message : ffuShop.translation[lang].checkout.noDelivery,\r\n                            status : 'danger'\r\n                        });\r\n                        valid = false;\r\n                    }\r\n\r\n                    if ( !valid ) {\r\n\r\n                        $('.fs-transition-holder .fs-checkout-options').removeClass('fs-hide-danger');\r\n                        setTimeout(function(){\r\n                            $('.fs-transition-holder .fs-checkout-options').addClass('fs-hide-danger');\r\n                            self.active = true;\r\n                        }, 2000, self);\r\n                        return;\r\n                    }\r\n\r\n                    self.setPage( self.page+1, true );\r\n                    self.active = true;\r\n                }\r\n                \r\n                if ( ! this.user.valid ) {\r\n                    UIkit.notification({\r\n                        message : ffuShop.translation[lang].checkout.noUser,\r\n                        status : 'danger'\r\n                    });\r\n                    valid = false;                    \r\n                } else if ( ! this.user.registered ) {\r\n                    \r\n                    // register user\r\n                    this.registerUser()\r\n                        .then(function(){\r\n                            ffuShop.store.commit('setUserInfo', ['registered', true]);\r\n                            processDeliveryValidation();\r\n                        })\r\n                        .catch(ffuShop.helpers.errorHandler);\r\n                } else {\r\n                    processDeliveryValidation();\r\n                }\r\n            },\r\n\r\n            validatePayment : function() {\r\n                this.setPage( this.page+1, true );\r\n            },\r\n\r\n            confirmOrder : function() {\r\n                var order = this.$store.state.order;\r\n                var self = this;\r\n              \r\n                //order.delivery.details = this.$store.getters.deliveryDetails;\r\n                order.delivery.details = this.$store.getters.deliveryDetails;\r\n                order.delivery.warehouse = this.$store.getters.deliveryDetailsWarehouse;\r\n                order.delivery.cost = this.$store.getters.deliveryCost\r\n\r\n                order.user = this.$store.state.user;\r\n                order.products = this.$store.state.products;\r\n\r\n                $.ajax({\r\n                    type: ffuShop.routes.checkout.confirm.req,\r\n                    url: ffuShop.routes.checkout.confirm.url,\r\n                    data: order,\r\n                    dataType: 'json',\r\n                    success: function(res) {\r\n                        \r\n                        switch ( res.action ) {\r\n                            \r\n                            case 'redirect' :\r\n                                location.href = res.url;\r\n                                break;\r\n                            case 'pay' :\r\n                                var form = $(res.form);\r\n                                form.appendTo( $('body') ).submit();\r\n                                break;\r\n                            case 'quantity' :\r\n                                UIkit.notification({\r\n                                    status : 'warning',\r\n                                    message : res.message\r\n                                });\r\n                                self.$store.dispatch('getProducts');\r\n                                break;\r\n                        }\r\n                    },\r\n                    error : function(err, text) {\r\n                        console.log(text, err);\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        /*created : function() {\r\n            this.$store.dispatch('getUser')\r\n        }*/\r\n    })\r\n})"]}